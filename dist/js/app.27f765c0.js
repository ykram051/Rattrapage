(function(){"use strict";var e={9479:function(e,t,s){s(4114);var n=s(5130),o=s(6768);const r={id:"app"};function a(e,t,s,n,a,i){const c=(0,o.g2)("router-link"),u=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("nav",null,[(0,o.bF)(c,{to:"/"},{default:(0,o.k6)((()=>[(0,o.eW)("Home")])),_:1}),a.currentUser?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(c,{key:0,to:"/login"},{default:(0,o.k6)((()=>[(0,o.eW)("Login")])),_:1})),a.currentUser?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(c,{key:1,to:"/register"},{default:(0,o.k6)((()=>[(0,o.eW)("Register")])),_:1})),a.currentUser?((0,o.uX)(),(0,o.CE)("button",{key:2,onClick:t[0]||(t[0]=(...e)=>i.signOut&&i.signOut(...e))},"Sign Out")):(0,o.Q3)("",!0)]),(0,o.bF)(u)])}var i=s(2829);s(2234),s(8307);const c={apiKey:"AIzaSyAjNghy6ruAoStwvKi9PPA7GBe6jLI-y1c",authDomain:"forum-409f1.firebaseapp.com",projectId:"forum-409f1",storageBucket:"forum-409f1.appspot.com",messagingSenderId:"795161880345",appId:"1:795161880345:web:21ac114342253123188788"};i.A.apps.length||i.A.initializeApp(c);const u=i.A.auth(),l=i.A.firestore();var d={name:"App",data(){return{currentUser:null}},created(){u.onAuthStateChanged((e=>{this.currentUser=e}))},methods:{signOut(){u.signOut().then((()=>{this.$router.push("/login")})).catch((e=>{console.error("Sign Out Error",e)}))}}},v=s(1241);const p=(0,v.A)(d,[["render",a],["__scopeId","data-v-58d5341f"]]);var h=p,m=s(1387);const f={class:"home-container"},g=(0,o.Lk)("h1",{class:"home-title"},"Welcome to the Student Voting App",-1),y={class:"event-list"};function k(e,t,s,n,r,a){const i=(0,o.g2)("EventList");return(0,o.uX)(),(0,o.CE)("div",f,[g,(0,o.Lk)("div",y,[(0,o.bF)(i)])])}const w={class:"event-list-container"},L=(0,o.Lk)("h2",{class:"event-list-title"},"Events",-1),b={class:"event-items"};function V(e,t,s,n,r,a){const i=(0,o.g2)("EventItem");return(0,o.uX)(),(0,o.CE)("div",w,[L,(0,o.Lk)("div",b,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.events,(e=>((0,o.uX)(),(0,o.Wv)(i,{key:e.id,event:e},null,8,["event"])))),128))])])}var A=s(4232);const E={class:"event-item"},_={class:"event-title"},C={class:"event-date"};function I(e,t,s,n,r,a){const i=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("div",E,[(0,o.Lk)("h3",_,(0,A.v_)(s.event.title),1),(0,o.Lk)("p",C,(0,A.v_)(s.event.description),1),(0,o.bF)(i,{to:`/event/${s.event.id}`,class:"view-details"},{default:(0,o.k6)((()=>[(0,o.eW)("View Details")])),_:1},8,["to"])])}var O={props:["event"]};const U=(0,v.A)(O,[["render",I]]);var X=U,$={components:{EventItem:X},data(){return{events:[]}},async created(){try{const e=await l.collection("events").get();this.events=e.docs.map((e=>({id:e.id,...e.data()})))}catch(e){console.error("Error fetching events: ",e)}}};const P=(0,v.A)($,[["render",V]]);var W=P,S={components:{EventList:W}};const D=(0,v.A)(S,[["render",k]]);var T=D;const j={class:"event-detail-container"},x={class:"event-title"},q={class:"event-description"},R={class:"event-date"},F={class:"event-created"},Q=(0,o.Lk)("span",{class:"label"},"Created:",-1),z={class:"event-updated"},J=(0,o.Lk)("span",{class:"label"},"Last Updated:",-1),Y={class:"event-votes"},B={class:"vote-count"},K={class:"vote-count"};function M(e,t,s,n,r,a){return(0,o.uX)(),(0,o.CE)("div",j,[(0,o.Lk)("h2",x,(0,A.v_)(r.event.title),1),(0,o.Lk)("p",q,(0,A.v_)(r.event.description),1),(0,o.Lk)("p",R,"Date: "+(0,A.v_)(new Date(r.event.date).toLocaleDateString()),1),(0,o.Lk)("p",F,[Q,(0,o.eW)(" "+(0,A.v_)(new Date(r.event.createdAt).toLocaleString()),1)]),(0,o.Lk)("p",z,[J,(0,o.eW)(" "+(0,A.v_)(new Date(r.event.updatedAt).toLocaleString()),1)]),(0,o.Lk)("div",Y,[(0,o.Lk)("span",{class:"yes-votes",onClick:t[0]||(t[0]=e=>a.vote("yes"))},[(0,o.eW)(" Yes: "),(0,o.Lk)("span",B,(0,A.v_)(r.event.yesVotes),1)]),(0,o.Lk)("span",{class:"no-votes",onClick:t[1]||(t[1]=e=>a.vote("no"))},[(0,o.eW)(" No: "),(0,o.Lk)("span",K,(0,A.v_)(r.event.noVotes),1)])])])}const N={class:"vote-buttons"};function H(e,t,s,n,r,a){return(0,o.uX)(),(0,o.CE)("div",N,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=e=>a.vote("yes")),class:"yes-vote"},"Yes"),(0,o.Lk)("button",{onClick:t[1]||(t[1]=e=>a.vote("no")),class:"no-vote"},"No")])}var Z={props:["eventId"],methods:{async vote(e){const t=u.currentUser.uid,s=l.collection("votes").doc(`${this.eventId}_${t}`),n=l.collection("events").doc(this.eventId);try{await l.runTransaction((async o=>{const r=await o.get(s);if(r.exists)alert("You have already voted for this event.");else{const r=await o.get(n),a=r.data();"yes"===e?(o.update(n,{yesVotes:a.yesVotes+1}),this.$emit("update-votes",{yesVotes:a.yesVotes+1,noVotes:a.noVotes})):(o.update(n,{noVotes:a.noVotes+1}),this.$emit("update-votes",{yesVotes:a.yesVotes,noVotes:a.noVotes+1})),o.set(s,{eventId:this.eventId,userId:t,vote:e})}}))}catch(o){console.error("Transaction failed: ",o)}}}};const G=(0,v.A)(Z,[["render",H]]);var ee=G,te={components:{VoteButton:ee},data(){return{event:{}}},async created(){const e=this.$route.params.id,t=await l.collection("events").doc(e).get();this.event={id:t.id,...t.data()}},methods:{updateVotes(e){this.event.yesVotes=e.yesVotes,this.event.noVotes=e.noVotes},async vote(e){const t=u.currentUser.uid,s=l.collection("votes").doc(`${this.event.id}_${t}`),n=l.collection("events").doc(this.event.id);try{await l.runTransaction((async o=>{const r=await o.get(s);if(r.exists)alert("You have already voted for this event.");else{const r=await o.get(n),a=r.data();"yes"===e?(o.update(n,{yesVotes:a.yesVotes+1}),this.updateVotes({yesVotes:a.yesVotes+1,noVotes:a.noVotes})):(o.update(n,{noVotes:a.noVotes+1}),this.updateVotes({yesVotes:a.yesVotes,noVotes:a.noVotes+1})),o.set(s,{eventId:this.event.id,userId:t,vote:e})}}))}catch(o){console.error("Transaction failed: ",o)}}}};const se=(0,v.A)(te,[["render",M]]);var ne=se;const oe={class:"login-container"},re=(0,o.Lk)("h2",null,"Login",-1),ae=(0,o.Lk)("button",{type:"submit"},"Login",-1),ie={key:0,class:"error-message"};function ce(e,t,s,r,a,i){return(0,o.uX)(),(0,o.CE)("div",oe,[re,(0,o.Lk)("form",{onSubmit:t[2]||(t[2]=(0,n.D$)(((...e)=>i.login&&i.login(...e)),["prevent"])),class:"login-form"},[(0,o.bo)((0,o.Lk)("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=e=>a.email=e),placeholder:"Email",required:""},null,512),[[n.Jo,a.email]]),(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),placeholder:"Password",required:""},null,512),[[n.Jo,a.password]]),ae],32),a.error?((0,o.uX)(),(0,o.CE)("p",ie,(0,A.v_)(a.error),1)):(0,o.Q3)("",!0)])}var ue={data(){return{email:"",password:"",error:""}},methods:{async login(){const e=/^[a-zA-Z0-9._%+-]+@um6p\.ma$/;if(e.test(this.email))try{await u.signInWithEmailAndPassword(this.email,this.password),this.$router.push("/")}catch(t){switch(t.code){case"auth/user-not-found":this.error="This email does not exist. Please register or use a valid email.";break;case"auth/wrong-password":this.error="The password is incorrect. Please try again.";break;case"auth/invalid-email":this.error="The email address is invalid. Please enter a valid email.";break;default:this.error="This email does not exist. Please register or use a valid email."}}else this.error="Email must be a valid UM6P email address"}}};const le=(0,v.A)(ue,[["render",ce]]);var de=le;const ve={class:"register-container"},pe=(0,o.Lk)("h2",null,"Register",-1),he=(0,o.Lk)("button",{type:"submit"},"Register",-1),me={key:0,class:"error-message"};function fe(e,t,s,r,a,i){return(0,o.uX)(),(0,o.CE)("div",ve,[pe,(0,o.Lk)("form",{onSubmit:t[2]||(t[2]=(0,n.D$)(((...e)=>i.register&&i.register(...e)),["prevent"])),class:"register-form"},[(0,o.bo)((0,o.Lk)("input",{type:"email","onUpdate:modelValue":t[0]||(t[0]=e=>a.email=e),placeholder:"Email",required:""},null,512),[[n.Jo,a.email]]),(0,o.bo)((0,o.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>a.password=e),placeholder:"Password",required:""},null,512),[[n.Jo,a.password]]),he],32),a.error?((0,o.uX)(),(0,o.CE)("p",me,(0,A.v_)(a.error),1)):(0,o.Q3)("",!0)])}var ge={data(){return{email:"",password:"",error:""}},methods:{async register(){const e=/^[a-zA-Z0-9._%+-]+@um6p\.ma$/;if(e.test(this.email))try{await u.createUserWithEmailAndPassword(this.email,this.password),this.$router.push("/")}catch(t){this.error=t.message}else this.error="Email must be a valid UM6P email address"}}};const ye=(0,v.A)(ge,[["render",fe]]);var ke=ye;const we=[{path:"/",name:"Home",component:T,meta:{requiresAuth:!0}},{path:"/event/:id",name:"EventDetail",component:ne,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:de},{path:"/register",name:"Register",component:ke}],Le=(0,m.aE)({history:(0,m.LA)("/"),routes:we});Le.beforeEach(((e,t,s)=>{const n=e.matched.some((e=>e.meta.requiresAuth)),o=u.currentUser;n&&!o?s("/login"):"/login"!==e.path&&"/register"!==e.path||!o?s():s("/")}));var be=Le;let Ve;u.onAuthStateChanged((e=>{Ve||(Ve=(0,n.Ef)(h).use(be).mount("#app")),e?"/login"!==be.currentRoute.value.path&&"/register"!==be.currentRoute.value.path||be.push("/"):be.currentRoute.value.meta.requiresAuth&&be.push("/login")}))}},t={};function s(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,s),r.exports}s.m=e,function(){var e=[];s.O=function(t,n,o,r){if(!n){var a=1/0;for(l=0;l<e.length;l++){n=e[l][0],o=e[l][1],r=e[l][2];for(var i=!0,c=0;c<n.length;c++)(!1&r||a>=r)&&Object.keys(s.O).every((function(e){return s.O[e](n[c])}))?n.splice(c--,1):(i=!1,r<a&&(a=r));if(i){e.splice(l--,1);var u=o();void 0!==u&&(t=u)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[n,o,r]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,r,a=n[0],i=n[1],c=n[2],u=0;if(a.some((function(t){return 0!==e[t]}))){for(o in i)s.o(i,o)&&(s.m[o]=i[o]);if(c)var l=c(s)}for(t&&t(n);u<a.length;u++)r=a[u],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(l)},n=self["webpackChunkforumtest"]=self["webpackChunkforumtest"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=s.O(void 0,[504],(function(){return s(9479)}));n=s.O(n)})();
//# sourceMappingURL=app.27f765c0.js.map